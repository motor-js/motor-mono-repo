{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _class, _temp2;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _WaterMarkCanvas = require('./WaterMarkCanvas');\n\nvar _WaterMarkCanvas2 = _interopRequireDefault(_WaterMarkCanvas);\n\nvar _SecurityDefense = require('./SecurityDefense');\n\nvar _SecurityDefense2 = _interopRequireDefault(_SecurityDefense);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar defaultOptions = {\n  chunkWidth: 200,\n  chunkHeight: 60,\n  textAlign: 'left',\n  textBaseline: 'bottom',\n  globalAlpha: 0.17,\n  font: '14px Microsoft Yahei',\n  rotateAngle: -0.26,\n  fillStyle: '#666'\n};\nvar waterMarkStyle = 'position: absolute;left: 0;right: 0;top:0;bottom:0;opacity: 0.7;z-index: 9999;pointer-events: none;overflow: hidden;background-color: transparent;background-repeat: repeat;';\n\nvar noop = function noop() {};\n\nvar WaterMark = (_temp2 = _class = function (_React$Component) {\n  _inherits(WaterMark, _React$Component);\n\n  function WaterMark() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, WaterMark);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = WaterMark.__proto__ || Object.getPrototypeOf(WaterMark)).call.apply(_ref, [this].concat(args))), _this), _this.getStyles = function () {\n      var _this$props = _this.props,\n          waterMarkText = _this$props.waterMarkText,\n          options = _this$props.options;\n      var newOptions = Object.assign({}, defaultOptions, options);\n      return (0, _WaterMarkCanvas2.default)(waterMarkText, newOptions);\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(WaterMark, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var dom = document.getElementById('water-mark-observer');\n      var parent = document.getElementById('water-mark-wrapper');\n      var securityAlarm = this.props.securityAlarm;\n      var security = new _SecurityDefense2.default(waterMarkStyle, this.getStyles, securityAlarm);\n      security.registerNodeRemoveListener(dom, parent);\n      security.registerNodeAttrChangeListener(dom);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var children = this.props.children;\n      var styles = {\n        position: 'absolute',\n        left: 0,\n        right: 0,\n        top: 0,\n        bottom: 0,\n        opacity: 0.7,\n        zIndex: 9999,\n        pointerEvents: 'none',\n        overflow: 'hidden',\n        backgroundImage: 'url(\"' + this.getStyles() + '\")',\n        backgroundColor: 'transparent',\n        backgroundRepeat: 'repeat'\n      };\n      return _react2.default.createElement('div', {\n        style: {\n          position: 'relative'\n        },\n        id: 'water-mark-wrapper'\n      }, _react2.default.createElement('div', {\n        style: styles,\n        id: 'water-mark-observer'\n      }), children);\n    }\n  }]);\n\n  return WaterMark;\n}(_react2.default.Component), _class.propTypes = {\n  children: _propTypes2.default.element.isRequired,\n  waterMarkText: _propTypes2.default.string.isRequired,\n  securityAlarm: _propTypes2.default.func,\n  options: _propTypes2.default.shape({\n    chunkWidth: _propTypes2.default.number,\n    chunkHeight: _propTypes2.default.number,\n    textAlign: _propTypes2.default.string,\n    textBaseline: _propTypes2.default.string,\n    globalAlpha: _propTypes2.default.number,\n    font: _propTypes2.default.string,\n    rotateAngle: _propTypes2.default.number,\n    fillStyle: _propTypes2.default.string\n  })\n}, _temp2);\nWaterMark.defaultProps = {\n  securityAlarm: noop,\n  options: defaultOptions\n};\nexports.default = WaterMark;\nmodule.exports = exports['default'];","map":{"version":3,"sources":["../src/index.js"],"names":["defaultOptions","chunkWidth","chunkHeight","textAlign","textBaseline","globalAlpha","font","rotateAngle","fillStyle","waterMarkStyle","noop","WaterMark","React","Component","propTypes","children","PropTypes","waterMarkText","securityAlarm","options","string","dom","document","parent","security","SecurityDefense","getStyles","newOptions","Object","styles","position","left","right","top","bottom","opacity","zIndex","pointerEvents","overflow","backgroundImage","backgroundColor","backgroundRepeat"],"mappings":"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","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport getWaterMarkCanvas from './WaterMarkCanvas'\nimport SecurityDefense from './SecurityDefense'\n\nconst defaultOptions = {\n  chunkWidth: 200,\n  chunkHeight: 60,\n  textAlign: 'left',\n  textBaseline: 'bottom',\n  globalAlpha: 0.17,\n  font: '14px Microsoft Yahei',\n  rotateAngle: -0.26,\n  fillStyle: '#666'\n}\n\nconst waterMarkStyle = 'position: absolute;left: 0;right: 0;top:0;bottom:0;opacity: 0.7;z-index: 9999;pointer-events: none;overflow: hidden;background-color: transparent;background-repeat: repeat;'\nconst noop = function () {}\n\nclass WaterMark extends React.Component {\n  static propTypes = {\n    children: PropTypes.element.isRequired,\n    waterMarkText: PropTypes.string.isRequired,\n    securityAlarm: PropTypes.func,\n    options: PropTypes.shape({\n      chunkWidth: PropTypes.number,\n      chunkHeight: PropTypes.number,\n      textAlign: PropTypes.string,\n      textBaseline: PropTypes.string,\n      globalAlpha: PropTypes.number,\n      font: PropTypes.string,\n      rotateAngle: PropTypes.number,\n      fillStyle: PropTypes.string\n    })\n  }\n\n  componentDidMount() {\n    const dom = document.getElementById('water-mark-observer')\n    const parent = document.getElementById('water-mark-wrapper')\n    const { securityAlarm } = this.props\n    const security = new SecurityDefense(waterMarkStyle, this.getStyles, securityAlarm)\n    security.registerNodeRemoveListener(dom, parent)\n    security.registerNodeAttrChangeListener(dom)\n  }\n\n  getStyles = () => {\n    const { waterMarkText, options } = this.props\n    const newOptions = Object.assign({}, defaultOptions, options)\n    return getWaterMarkCanvas(waterMarkText, newOptions)\n  }\n\n  render() {\n    const { children } = this.props\n    const styles = {\n      position: 'absolute',\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0,\n      opacity: 0.7,\n      zIndex: 9999,\n      pointerEvents: 'none',\n      overflow: 'hidden',\n      backgroundImage: `url(\"${this.getStyles()}\")`,\n      backgroundColor: 'transparent',\n      backgroundRepeat: 'repeat'\n    }\n\n    return (\n      <div style={{ position: 'relative' }} id=\"water-mark-wrapper\">\n        <div style={styles} id=\"water-mark-observer\" />\n        {children}\n      </div>\n    )\n  }\n}\n\nWaterMark.defaultProps = {\n  securityAlarm: noop,\n  options: defaultOptions\n}\n\nexport default WaterMark\n"]},"metadata":{},"sourceType":"script"}